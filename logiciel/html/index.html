 <!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Security-Policy" content="script-src 'self' 'unsafe-inline';" />
    <link rel="stylesheet" href="../css/index.css">  
     
    <script type="text/javascript" src="../js/index.js"></script>
    <title>Connexion</title>
  </head>
  <body>
    
    <div id="container">

      <form action="voiture.html" method="POST" >

          <h1>Connectez-vous : </h1>
          <label><b>Nom d'utilisateur</b></label>
          <input type="text" placeholder="Entrer le nom d'utilisateur" name="username" value="username" required>
          <br><br>
          <label><b>Mot de passe</b></label>
          <input type="password" placeholder="Entrer le mot de passe" name="password" value="Mot de passe" required>
          <br><br>
          <!-- <button type="submit" id='submit' onclick="goToSettingsWindow()" value='Connexion' >   -->
           <button type ="submit" id = "submit" onclick="setClientToken()">Connexion</button>
           
        </form> 

    
      </div>
      <script>
        const { getSession, createSession } = require("./keygen")
        const { ipcRenderer } = require("electron")
  
        // Check session si elle existe
        const session = getSession()
        if (session != null) {
          ipcRenderer.send("authenticated")
        }
  
        // Authentification et crÃ©ation nouvelle session
        const login = document.getElementById("login")
  
        login.addEventListener("submit", async (event) => {
          event.preventDefault()
  
          const email = document.getElementById("email")
          const password = document.getElementById("password")
          const { token, errors } = await createSession(email.value, password.value)
          if (errors) {
            const [{ title, detail }] = errors
  
            alert(`${title}: ${detail}`)
  
            return false
          }
  
          ipcRenderer.send("authenticated")
        })
      </script>
        
  </body>

</html>
